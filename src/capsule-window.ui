<?xml version="1.0" encoding="UTF-8"?>
<!--
  Copyright 2023 Christian Hergert

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.

  SPDX-License-Identifier: GPL-3.0-or-later
-->
<interface>
  <requires lib="gtk" version="4.0"/>
  <requires lib="Adw" version="1.0"/>
  <template class="CapsuleWindow" parent="AdwApplicationWindow">
    <style>
      <class name="capsule-window"/>
    </style>
    <child>
      <object class="GtkShortcutController">
        <property name="propagation-phase">capture</property>
        <child>
          <object class="GtkShortcut">
            <property name="trigger">&lt;ctrl&gt;&lt;shift&gt;n</property>
            <property name="action">action(win.new-window)</property>
            <property name="arguments">''</property>
          </object>
        </child>
        <child>
          <object class="GtkShortcut">
            <property name="trigger">&lt;ctrl&gt;&lt;shift&gt;t</property>
            <property name="action">action(win.new-tab)</property>
            <property name="arguments">''</property>
          </object>
        </child>
        <child>
          <object class="GtkShortcut">
            <property name="trigger">&lt;ctrl&gt;&lt;shift&gt;o</property>
            <property name="action">action(win.tab-overview)</property>
          </object>
        </child>
        <child>
          <object class="GtkShortcut">
            <property name="trigger">&lt;ctrl&gt;comma</property>
            <property name="action">action(app.preferences)</property>
          </object>
        </child>
        <child>
          <object class="GtkShortcut">
            <property name="trigger">&lt;ctrl&gt;minus</property>
            <property name="action">action(win.zoom-out)</property>
          </object>
        </child>
        <child>
          <object class="GtkShortcut">
            <property name="trigger">&lt;ctrl&gt;0</property>
            <property name="action">action(win.zoom-one)</property>
          </object>
        </child>
        <child>
          <object class="GtkShortcut">
            <property name="trigger">&lt;ctrl&gt;plus</property>
            <property name="action">action(win.zoom-in)</property>
          </object>
        </child>
        <child>
          <object class="GtkShortcut">
            <property name="trigger">F11</property>
            <property name="action">action(win.toggle-fullscreen)</property>
          </object>
        </child>
      </object>
    </child>
    <property name="content">
      <object class="AdwTabOverview" id="tab_overview">
        <property name="view">tab_view</property>
        <property name="child">
          <object class="AdwToolbarView">
            <property name="top-bar-style">raised</property>
            <child type="top">
              <object class="GtkBox" id="visual_bell">
                <property name="orientation">vertical</property>
                <child>
                  <object class="AdwHeaderBar" id="header_bar">
                    <child type="start">
                      <object class="AdwSplitButton">
                        <property name="icon-name">tab-new-symbolic</property>
                        <property name="tooltip-text" translatable="yes">New Terminal</property>
                        <property name="action-name">win.new-terminal</property>
                        <property name="action-target">'default'</property>
                        <property name="focus-on-click">false</property>
                        <binding name="menu-model">
                          <lookup name="profile-menu" type="CapsuleApplication">
                            <lookup name="application">CapsuleWindow</lookup>
                          </lookup>
                        </binding>
                      </object>
                    </child>
                    <child type="title">
                      <object class="AdwWindowTitle">
                        <binding name="subtitle">
                          <lookup name="subtitle" type="CapsuleTab">
                            <lookup name="active-tab">CapsuleWindow</lookup>
                          </lookup>
                        </binding>
                        <binding name="title">
                          <lookup name="title" type="CapsuleTab">
                            <lookup name="active-tab">CapsuleWindow</lookup>
                          </lookup>
                        </binding>
                      </object>
                    </child>
                    <child type="end">
                      <object class="GtkMenuButton">
                        <property name="primary">true</property>
                        <property name="icon-name">open-menu-symbolic</property>
                        <property name="tooltip-text" translatable="yes">Menu</property>
                        <property name="menu-model">primary_menu</property>
                        <property name="focus-on-click">false</property>
                      </object>
                    </child>
                    <child type="end">
                      <object class="GtkToggleButton">
                        <property name="icon-name">view-grid-symbolic</property>
                        <property name="tooltip-text" translatable="yes">Show Open Tabs</property>
                        <property name="active" bind-source="tab_overview" bind-property="open" bind-flags="bidirectional|sync-create"/>
                        <property name="focus-on-click">false</property>
                      </object>
                    </child>
                  </object>
                </child>
                <child>
                  <object class="AdwTabBar" id="tab_bar">
                    <property name="view">tab_view</property>
                  </object>
                </child>
              </object>
            </child>
            <property name="content">
              <object class="AdwToastOverlay" id="toasts">
                <child>
                  <object class="AdwTabView" id="tab_view">
                    <signal name="notify::selected-page" handler="capsule_window_notify_selected_page_cb" swapped="1"/>
                    <signal name="page-attached" handler="capsule_window_page_attached_cb" swapped="1"/>
                    <signal name="page-detached" handler="capsule_window_page_detached_cb" swapped="1"/>
                    <signal name="create-window" handler="capsule_window_create_window_cb" swapped="1"/>
                    <signal name="close-page" handler="capsule_window_close_page_cb" swapped="1"/>
                    <signal name="setup-menu" handler="capsule_window_setup_menu_cb" swapped="1"/>
                    <property name="menu-model">tab_menu</property>
                  </object>
                </child>
              </object>
            </property>
          </object>
        </property>
      </object>
    </property>
  </template>
  <menu id="primary_menu">
    <section>
      <attribute name="display-hint">horizontal-buttons</attribute>
      <item>
        <attribute name="action">win.zoom-out</attribute>
        <attribute name="accel">&lt;ctrl&gt;minus</attribute>
        <attribute name="verb-icon">zoom-out-symbolic</attribute>
      </item>
      <item>
        <attribute name="action">win.zoom-one</attribute>
        <attribute name="accel">&lt;ctrl&gt;0</attribute>
        <attribute name="verb-icon">zoom-original-symbolic</attribute>
      </item>
      <item>
        <attribute name="action">win.zoom-in</attribute>
        <attribute name="accel">&lt;ctrl&gt;plus</attribute>
        <attribute name="verb-icon">zoom-in-symbolic</attribute>
      </item>
    </section>
    <section>
      <item>
        <attribute name="label" translatable="yes">New _Tab</attribute>
        <attribute name="action">win.new-tab</attribute>
        <attribute name="target" type="s">'default'</attribute>
        <attribute name="accel">&lt;ctrl&gt;&lt;shift&gt;t</attribute>
      </item>
      <item>
        <attribute name="label" translatable="yes">New _Window</attribute>
        <attribute name="action">win.new-window</attribute>
        <attribute name="target" type="s">'default'</attribute>
        <attribute name="accel">&lt;ctrl&gt;&lt;shift&gt;n</attribute>
      </item>
    </section>
    <section>
      <item>
        <attribute name="label" translatable="yes">View Open Tabs</attribute>
        <attribute name="action">win.tab-overview</attribute>
        <attribute name="accel">&lt;ctrl&gt;&lt;shift&gt;o</attribute>
      </item>
    </section>
    <section>
      <item>
        <attribute name="label" translatable="yes">Fullscreen</attribute>
        <attribute name="action">win.fullscreen</attribute>
        <attribute name="hidden-when">action-disabled</attribute>
        <attribute name="accel">F11</attribute>
      </item>
      <item>
        <attribute name="label" translatable="yes">Leave Fullscreen</attribute>
        <attribute name="action">win.unfullscreen</attribute>
        <attribute name="hidden-when">action-disabled</attribute>
        <attribute name="accel">F11</attribute>
      </item>
    </section>
    <section>
      <item>
        <attribute name="label" translatable="yes">_Preferences</attribute>
        <attribute name="action">app.preferences</attribute>
      </item>
      <item>
        <attribute name="label" translatable="yes">_Keyboard Shortcuts</attribute>
        <attribute name="action">win.show-help-overlay</attribute>
      </item>
      <item>
        <attribute name="label" translatable="yes">_About Capsule</attribute>
        <attribute name="action">app.about</attribute>
      </item>
    </section>
  </menu>
  <menu id="tab_menu">
    <section>
      <item>
        <attribute name="label" translatable="yes">Move _Left</attribute>
        <attribute name="action">page.move-left</attribute>
      </item>
      <item>
        <attribute name="label" translatable="yes">Move _Right</attribute>
        <attribute name="action">page.move-right</attribute>
      </item>
      <item>
        <attribute name="label" translatable="yes">Move to New _Window</attribute>
        <attribute name="action">page.detach</attribute>
      </item>
    </section>
    <section>
      <item>
        <attribute name="label" translatable="yes">Reset</attribute>
        <attribute name="action">tab.reset</attribute>
        <attribute name="target" type="b">false</attribute>
      </item>
      <item>
        <attribute name="label" translatable="yes">Reset and Clear</attribute>
        <attribute name="action">tab.reset</attribute>
        <attribute name="target" type="b">true</attribute>
      </item>
    </section>
    <section>
      <item>
        <attribute name="label" translatable="yes">Read Only</attribute>
        <attribute name="action">win.tab.read-only</attribute>
      </item>
    </section>
    <section>
      <item>
        <attribute name="label" translatable="yes">Close _Other Tabs</attribute>
        <attribute name="action">page.close-others</attribute>
      </item>
      <item>
        <attribute name="label" translatable="yes">_Close Tab</attribute>
        <attribute name="action">page.close</attribute>
      </item>
    </section>
  </menu>
</interface>
